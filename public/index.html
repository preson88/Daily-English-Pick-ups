<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily English Pick-ups</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5583094134831289" crossorigin="anonymous"></script>

    <style>
        :root {
            --bg-color: #f7f6f2; --text-color: #2c3e50; --card-bg: #ffffff;
            --border-color: #e8e6e1; --sub-text: #7f8c8d; --input-bg: #fdfdfd;
            --note-bg: #ffffff; --original-box-bg: #fdfaf4; --point-color: #f39c12;
        }
        body.dark-mode {
            --bg-color: #1a1a1a; --text-color: #ecf0f1; --card-bg: #2c2c2c;
            --border-color: #3d3d3d; --sub-text: #95a5a6; --input-bg: #1a1a1a;
            --note-bg: #2c2c2c; --original-box-bg: #3d3d3d;
        }
        body { font-family: 'Noto Sans KR', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 15px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; transition: background-color 0.3s, color 0.3s; }
        .container { width: 100%; max-width: 600px; margin-top: 20px; position: relative; padding-bottom: 120px; }
        #themeToggleBtn { position: absolute; top: -10px; right: 0; background: none; border: none; font-size: 24px; color: var(--point-color); cursor: pointer; transition: transform 0.2s; }
        #themeToggleBtn:hover { transform: scale(1.1); }
        .header-area { text-align: center; margin-bottom: 25px; margin-top: 20px; }
        .main-title { font-size: 28px; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 8px; color: var(--text-color); cursor: pointer; transition: opacity 0.2s; }

        .input-card { background-color: var(--card-bg); border-radius: 16px; padding: 20px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.03); margin-bottom: 20px; border: 1px solid var(--border-color); transition: background-color 0.3s; }
        .input-label { font-size: 13px; font-weight: 700; color: var(--text-color); margin-bottom: 12px; display: block; }
        .input-box { display: flex; background-color: var(--input-bg); border: 1px solid var(--border-color); border-radius: 8px; padding: 4px; align-items: center; }
        #micBtn { background: none; border: none; color: #9ca3af; font-size: 18px; cursor: pointer; padding: 0 10px; }
        #koreanInput { flex: 1; border: none; background: transparent; padding: 10px 5px; font-size: 15px; outline: none; width: 100%; color: var(--text-color); }
        #generateBtn { background-color: #3b82f6; color: white; border: none; border-radius: 6px; padding: 10px 15px; font-weight: 700; cursor: pointer; white-space: nowrap; }

        /* ê²°ê³¼ í™”ë©´ ë””ìì¸ */
        #result-screen, #archive-screen, #flashcard-screen, #loading-screen, #quiz-setup-screen { display: none; }
        .action-buttons-row { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 20px; }
        .action-btn { background-color: var(--card-bg); border: 2px solid var(--text-color); border-radius: 20px; padding: 8px 15px; font-size: 13px; font-weight: 700; color: var(--text-color); cursor: pointer; display: flex; align-items: center; gap: 6px; }
        .action-btn.dark { background-color: var(--text-color); color: var(--bg-color); }
        #capture-area { background-color: var(--note-bg); padding: 30px 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05); width: 100%; box-sizing: border-box; margin-bottom: 20px; color: var(--text-color); }
        .original-sentence-box { background-color: var(--original-box-bg); border: 1px solid var(--border-color); border-radius: 12px; padding: 15px; text-align: center; font-style: italic; margin-bottom: 30px; }
        .english-text { font-family: 'Georgia', serif; font-size: 18px; margin-bottom: 8px; font-weight: bold; }
        .voca-item { display: flex; align-items: center; padding: 10px 0; font-size: 14px; border-bottom: 1px solid var(--border-color); }
        .voca-heart { color: #e5e7eb; font-size: 18px; cursor: pointer; margin-left: auto; }
        .voca-heart.active { color: #ef4444; }

        /* ğŸ“± í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ & í‘¸í„° */
        .bottom-nav { position: fixed; bottom: 65px; left: 50%; transform: translateX(-50%); width: calc(100% - 30px); max-width: 600px; display: flex; padding: 8px; background-color: var(--card-bg); border: 1px solid var(--border-color); border-radius: 20px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); z-index: 999; }
        .nav-btn { flex: 1; background: none; border: none; border-radius: 16px; padding: 10px 6px; display: flex; flex-direction: column; align-items: center; gap: 6px; font-size: 12px; font-weight: 700; color: var(--text-color); cursor: pointer; }
        .nav-btn.active { background-color: rgba(243, 156, 18, 0.2); color: var(--point-color); }
        
        .footer-links { position: fixed; bottom: 15px; left: 50%; transform: translateX(-50%); width: 100%; text-align: center; font-size: 11px; color: var(--sub-text); z-index: 998; }
        .footer-links span { margin: 0 8px; cursor: pointer; text-decoration: underline; }

        /* ğŸ“„ ëª¨ë‹¬(Policy/About) ìŠ¤íƒ€ì¼ */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center; }
        .modal-content { background: var(--card-bg); padding: 25px; border-radius: 16px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto; position: relative; line-height: 1.6; }
        .modal-close { position: absolute; top: 15px; right: 15px; cursor: pointer; font-size: 20px; }

        /* ğŸ’° ê´‘ê³  ì˜ì—­ ìŠ¤íƒ€ì¼ */
        .ad-slot { width: 100%; text-align: center; margin: 15px 0; background: rgba(0,0,0,0.02); min-height: 50px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 10px; color: #ccc; border: 1px dashed #eee; }

        /* ğŸƒ í”Œë˜ì‹œì¹´ë“œ */
        .flashcard { background-color: var(--card-bg); border: 2px solid var(--text-color); border-radius: 16px; padding: 50px 20px; margin: 20px auto; min-height: 200px; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; }
        .fc-meaning { display: none; font-size: 20px; color: #3b82f6; }
        .fc-meaning.show { display: block; }

        #loading-screen { text-align: center; padding: 80px 20px; }
        .spinner { font-size: 45px; color: var(--point-color); animation: spin 1s linear infinite; margin-bottom: 25px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>

<body>
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()"><i class="fas fa-times"></i></span>
            <div id="modalBody"></div>
        </div>
    </div>

    <div id="ad-interstitial" class="ad-interstitial-overlay" style="display:none;">
        <div class="ad-interstitial-content">Google AdMob<br>ì „ë©´ ê´‘ê³ </div>
        <button class="ad-close-btn" onclick="closeInterstitial()">ê´‘ê³  ë‹«ê¸° (X)</button>
    </div>

    <div class="container">
        <button id="themeToggleBtn"><i class="fas fa-moon"></i></button>

        <div class="header-area">
            <div class="main-title" onclick="goToMain()">Daily English Pick-ups</div>
            
            <div class="ad-slot">
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5583094134831289" data-ad-slot="YOUR_SLOT_ID" data-ad-format="auto" data-full-width-responsive="true"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
            </div>
        </div>

        <div id="main-screen">
            <div class="input-card">
                <label class="input-label">í•™ìŠµí•  í•œêµ­ì–´ ë¬¸ì¥</label>
                <div class="input-box">
                    <button id="micBtn" title="ìŒì„± ì…ë ¥"><i class="fas fa-microphone"></i></button>
                    <input type="text" id="koreanInput" placeholder="ì˜ˆ: ë°°ê³ íŒŒ, í”¼ì ë¨¹ê³  ì‹¶ë‹¤">
                    <button id="generateBtn"><i class="far fa-paper-plane"></i> ìƒì„±</button>
                </div>
            </div>
        </div>

        <div id="loading-screen">
            <div class="spinner"><i class="fas fa-spinner"></i></div>
            <h3>AIê°€ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤... âœï¸âœ¨</h3>
        </div>

        <div id="result-screen">
            <div class="action-buttons-row">
                <button id="resSaveBookmarkBtn" class="action-btn" onclick="toggleBookmark()"><i class="far fa-bookmark"></i> ì €ì¥</button>
                <button class="action-btn" onclick="exportToA4('png')"><i class="fas fa-image"></i> PNG</button>
                <button class="action-btn dark" onclick="exportToA4('pdf')"><i class="fas fa-file-pdf"></i> PDF</button>
            </div>
            <div id="capture-area">
                <div class="note-header">ğŸ“ ì˜¤ëŠ˜ì˜ ì¤ì¤ ì˜ì–´ ë…¸íŠ¸</div>
                <div class="original-sentence-box">"<span id="inputSentenceDisplay"></span>"</div>
                <div id="result-container">
                    </div>
                <div class="voca-title">ğŸ’ ì¤ì¤ ë‹¨ì–´ì¥</div>
                <ul class="voca-list" id="vocaListContainer"></ul>
            </div>
            <div class="center-btn-wrap">
                <button class="archive-main-btn" onclick="goToMain()"><i class="fas fa-arrow-left"></i> ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
            </div>
        </div>

        <div id="archive-screen" class="archive-container">
            <div class="tab-menu">
                <button id="tabSentence" class="tab-btn active" onclick="switchTab('sentence')">ğŸ”– ë¬¸ì¥</button>
                <button id="tabWord" class="tab-btn" onclick="switchTab('word')">â¤ï¸ ë‹¨ì–´</button>
            </div>
            
            <div class="ad-slot">
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5583094134831289" data-ad-slot="YOUR_SLOT_ID" data-ad-format="auto" data-full-width-responsive="true"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
            </div>

            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." oninput="renderArchiveList()">
            </div>
            <ul id="sentenceList" class="archive-list"></ul>
            <ul id="wordList" class="archive-list" style="display:none;"></ul>
            <div id="quizBtnWrap" class="center-btn-wrap" style="display: none; margin-top:15px;">
                <button class="action-btn dark" onclick="openQuizSetup()"><i class="fas fa-clone"></i> ë‹¨ì–´ í€´ì¦ˆ í’€ê¸°</button>
            </div>
        </div>

        <div id="flashcard-screen">
            <div class="fc-progress" id="fcProgress">1 / 5</div>
            <div class="flashcard" onclick="flipCard()">
                <div id="fcSpeaker" class="fc-speaker" style="display:none; margin-bottom:10px;"><i class="fas fa-volume-up"></i></div>
                <div class="fc-word" id="fcWord">Word</div>
                <div class="fc-meaning" id="fcMeaning">Meaning</div>
                <div class="fc-instruction">í„°ì¹˜í•˜ë©´ ì •ë‹µì´ ë³´ì…ë‹ˆë‹¤ ğŸ‘†</div>
            </div>
            
            <div class="ad-slot">
                <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5583094134831289" data-ad-slot="YOUR_SLOT_ID" data-ad-format="auto" data-full-width-responsive="true"></ins>
                <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
            </div>

            <div class="fc-controls">
                <button class="archive-main-btn" onclick="closeFlashcard()">ê·¸ë§Œí•˜ê¸°</button>
                <button class="archive-main-btn" onclick="nextCard()" style="background-color: #111827; color: white;">ë‹¤ìŒ ë‹¨ì–´</button>
            </div>
        </div>

        <div id="quiz-setup-screen" style="display:none;">
            <div class="input-card">
                <h3>ğŸƒ ë‹¨ì–´ í€´ì¦ˆ ì„¤ì •</h3>
                <label class="input-label">ì¹´ë“œ í‘œì‹œ ì–¸ì–´</label>
                <select id="quizDirection" style="width:100%; padding:10px; margin-bottom:15px; border-radius:8px; border:1px solid var(--border-color);">
                    <option value="en-ko">ì˜ì–´ ë³´ê³  ë§ì¶”ê¸° (ì˜ â†’ í•œ)</option>
                    <option value="ko-en">í•œêµ­ì–´ ë³´ê³  ë§ì¶”ê¸° (í•œ â†’ ì˜)</option>
                </select>
                <label class="input-label">ë¬¸ì œ ê°œìˆ˜</label>
                <select id="quizCount" style="width:100%; padding:10px; margin-bottom:15px; border-radius:8px; border:1px solid var(--border-color);"></select>
                <label class="input-label">ì¶œì œ ë°©ì‹</label>
                <select id="quizMode" style="width:100%; padding:10px; margin-bottom:20px; border-radius:8px; border:1px solid var(--border-color);">
                    <option value="weak">ê¸°ë³¸ (ìì£¼ ì•ˆ ë³¸ ë‹¨ì–´)</option>
                    <option value="recent">ìµœê·¼ ì°œí•œ ë‹¨ì–´</option>
                </select>
                <button class="archive-main-btn" onclick="startQuiz()" style="width:100%; justify-content:center; background-color:#3b82f6; color:white; border:none;">í€´ì¦ˆ ì‹œì‘!</button>
            </div>
        </div>
    </div>

    <div class="bottom-nav">
        <button class="nav-btn active" id="navGenerateBtn" onclick="goToMain()"><i class="fas fa-plus-circle"></i>ë¬¸ì¥ìƒì„±</button>
        <button class="nav-btn" id="navArchiveBtn" onclick="openArchive()"><i class="fas fa-archive"></i>ë³´ê´€í•¨</button>
        <button class="nav-btn" id="navQuizBtn" onclick="openQuizSetup()"><i class="fas fa-clone"></i>ë‹¨ì–´í€´ì¦ˆ</button>
    </div>

    <div class="footer-links">
        <span onclick="showAbout()">About</span> | 
        <span onclick="showPrivacy()">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</span> | 
        <span onclick="showContact()">Contact</span>
        <div style="margin-top:5px; opacity:0.6;">Â© 2026 Daily English Pick-ups.</div>
    </div>

    <script>
        // --- ğŸ“‹ ì •ì±… ë°ì´í„° ---
        const policies = {
            about: `<h3>About (ì†Œê°œ)</h3><p>ì•ˆë…•í•˜ì„¸ìš”! 'ì˜¤ëŠ˜ì˜ ì¤ì¤ ì˜ì–´ ë…¸íŠ¸'ëŠ” ë‹¨ìˆœí•œ ë‹¨ì–´ ì•”ê¸°ë³´ë‹¤ ì¼ìƒì ìœ¼ë¡œ ìì£¼ ì“°ëŠ” í‘œí˜„ì„ ì§ì ‘ ë²ˆì—­í•˜ì—¬ ì§ì ‘ ë°œìŒí•˜ê³  ì™¸ìš°ë„ë¡ ë•ëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.</p>`,
            privacy: `<h3>ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</h3><p>ë³¸ ì‚¬ì´íŠ¸ëŠ” ë°©ë¬¸ìì˜ ê°œì¸ì •ë³´ë¥¼ ì†Œì¤‘íˆ ì—¬ê¸°ë©° ê´€ë ¨ ë²•ë ¹ì„ ì¤€ìˆ˜í•©ë‹ˆë‹¤.</p><b>1. ìˆ˜ì§‘ í•­ëª©</b><p>ë¬¸ì˜ ì–‘ì‹ ì´ìš© ì‹œ ì œê³µí•˜ëŠ” ì´ë¦„, ì´ë©”ì¼ ì£¼ì†Œ ë“±ì„ ìˆ˜ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><b>2. ì¿ í‚¤ ë° ê´‘ê³ </b><p>êµ¬ê¸€(Google) ì œ3ì ì œê³µì—…ì²´ëŠ” ì¿ í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°©ë¬¸ìì˜ ì´ì „ ê¸°ë¡ì„ ë°”íƒ•ìœ¼ë¡œ ë§ì¶¤í˜• ê´‘ê³ ë¥¼ ê²Œì¬í•©ë‹ˆë‹¤.</p>`,
            contact: `<h3>Contact</h3><p>ì œíœ´ ë° ê´‘ê³  ë¬¸ì˜:</p>ì´ë©”ì¼: <b>preson88@gmail.com</b><p>ìš´ì˜ ì‹œê°„: í‰ì¼ 10:00 ~ 17:00</p>`
        };

        function showAbout() { openModal(policies.about); }
        function showPrivacy() { openModal(policies.privacy); }
        function showContact() { openModal(policies.contact); }
        function openModal(content) { document.getElementById('modalBody').innerHTML = content; document.getElementById('infoModal').style.display = 'flex'; }
        function closeModal() { document.getElementById('infoModal').style.display = 'none'; }

        // --- âš™ï¸ ê¸°ì¡´ ê¸°ëŠ¥ ë¡œì§ (ë³€ë™ ì—†ìŒ) ---
        let savedSentences = JSON.parse(localStorage.getItem('mySentences')) || [];
        let savedWords = JSON.parse(localStorage.getItem('myWords')) || [];
        let generatedHistory = JSON.parse(localStorage.getItem('myHistoryData')) || {};
        let currentInput = "";
        let fcIndex = 0;
        let currentQuizList = [];

        // ë‹¤í¬ëª¨ë“œ
        let isDarkMode = localStorage.getItem('darkMode') === 'true';
        if (isDarkMode) document.body.classList.add('dark-mode');
        document.getElementById('themeToggleBtn').onclick = function() {
            document.body.classList.toggle('dark-mode');
            isDarkMode = document.body.classList.contains('dark-mode');
            localStorage.setItem('darkMode', isDarkMode);
            this.innerHTML = isDarkMode ? '<i class="fas fa-sun" style="color:#fbbf24;"></i>' : '<i class="fas fa-moon"></i>';
        };

        // ë©”ì¸ ìƒì„±
        document.getElementById('generateBtn').onclick = async function() {
            const val = document.getElementById('koreanInput').value;
            if (!val.trim()) return alert('ë¬¸ì¥ì„ ì…ë ¥í•˜ì„¸ìš”!');
            currentInput = val;
            hideAll(); document.getElementById('loading-screen').style.display = 'block';

            try {
                const res = await fetch('/api/generate', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ currentInput })
                });
                const data = await res.json();
                generatedHistory[currentInput] = data;
                localStorage.setItem('myHistoryData', JSON.stringify(generatedHistory));
                renderResultData(data);
            } catch (e) {
                alert('í†µì‹  ì˜¤ë¥˜!'); goToMain();
            }
        };

        function renderResultData(data) {
            document.getElementById('inputSentenceDisplay').textContent = currentInput;
            const container = document.getElementById('result-container');
            container.innerHTML = `
                ${['standard', 'native', 'slang'].map((key, i) => `
                    <div class="section-block">
                        <div class="section-title">
                            <div><span class="number-badge">${i+1}</span> ${key.toUpperCase()}</div>
                            <button class="speaker-btn" onclick="speakText('${data[key].en.replace(/'/g, "\\'")}')"><i class="fas fa-volume-up"></i></button>
                        </div>
                        <div class="english-text">"${data[key].en}"</div>
                        <div class="korean-text">=> ${data[key].ko}</div>
                        <div class="tip-box ${key}">ğŸ’¡ íŒ: ${data[key].tip}</div>
                    </div>
                `).join('')}
            `;
            const vocaList = document.getElementById('vocaListContainer');
            vocaList.innerHTML = data.voca.map(v => `
                <li class="voca-item">
                    <span>${v.emoji}</span> <b style="margin:0 8px;">${v.word}</b> ëœ»: ${v.meaning}
                    <i class="fas fa-heart voca-heart ${savedWords.some(sw => sw.word === v.word) ? 'active' : ''}" onclick="toggleWordLike(this, '${v.word}', '${v.meaning}', '${v.emoji}')"></i>
                </li>
            `).join('');
            
            updateBookmarkUI();
            hideAll(); document.getElementById('result-screen').style.display = 'block';
        }

        // ìœ í‹¸ë¦¬í‹°
        function speakText(text) { window.speechSynthesis.cancel(); const m = new SpeechSynthesisUtterance(text); m.lang = 'en-US'; window.speechSynthesis.speak(m); }
        function goToMain() { hideAll(); mainScreen.style.display = 'block'; updateNav('navGenerateBtn'); }
        function hideAll() { ['main-screen', 'result-screen', 'archive-screen', 'flashcard-screen', 'loading-screen', 'quiz-setup-screen'].forEach(s => document.getElementById(s).style.display = 'none'); }
        function updateNav(id) { document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active')); document.getElementById(id).classList.add('active'); }

        // ë³´ê´€í•¨ & í€´ì¦ˆ (ê¸°ì¡´ ì½”ë“œì™€ ë™ì¼í•˜ê²Œ ìœ ì§€)
        window.openArchive = function() { hideAll(); archiveScreen.style.display = 'block'; updateNav('navArchiveBtn'); renderArchiveList(); };
        window.openQuizSetup = function() { if(savedWords.length<1) return alert('ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤!'); hideAll(); document.getElementById('quiz-setup-screen').style.display = 'block'; updateNav('navQuizBtn'); };
        
        // í€´ì¦ˆ ë¡œì§
        window.startQuiz = function() {
            currentQuizList = [...savedWords].sort(() => Math.random() - 0.5).slice(0, 10);
            fcIndex = 0; hideAll(); document.getElementById('flashcard-screen').style.display = 'block'; showFc();
        };
        function showFc() {
            const w = currentQuizList[fcIndex];
            document.getElementById('fcWord').textContent = w.word;
            document.getElementById('fcMeaning').textContent = w.meaning;
            document.getElementById('fcMeaning').classList.remove('show');
            document.getElementById('fcProgress').textContent = `${fcIndex + 1} / ${currentQuizList.length}`;
        }
        window.flipCard = function() { document.getElementById('fcMeaning').classList.toggle('show'); };
        window.nextCard = function() { fcIndex++; if(fcIndex >= currentQuizList.length) { alert('ì™„ë£Œ!'); goToMain(); } else showFc(); };
        window.closeFlashcard = function() { goToMain(); };
        
        // ì €ì¥ ê¸°ëŠ¥
        window.toggleBookmark = function() {
            const idx = savedSentences.indexOf(currentInput);
            if(idx === -1) savedSentences.push(currentInput);
            else savedSentences.splice(idx, 1);
            localStorage.setItem('mySentences', JSON.stringify(savedSentences));
            updateBookmarkUI();
        };
        function updateBookmarkUI() {
            const saved = savedSentences.includes(currentInput);
            const btn = document.getElementById('resSaveBookmarkBtn');
            btn.innerHTML = saved ? '<i class="fas fa-bookmark"></i> ì™„ë£Œ' : '<i class="far fa-bookmark"></i> ì €ì¥';
        }
        window.toggleWordLike = function(el, word, meaning, emoji) {
            el.classList.toggle('active');
            if(el.classList.contains('active')) savedWords.push({word, meaning, emoji});
            else savedWords = savedWords.filter(w => w.word !== word);
            localStorage.setItem('myWords', JSON.stringify(savedWords));
        };
        window.exportToA4 = function(type) {
            html2canvas(document.getElementById('capture-area')).then(canvas => {
                const img = canvas.toDataURL('image/png');
                if(type==='png') { const a = document.createElement('a'); a.href = img; a.download = 'note.png'; a.click(); }
                else { const pdf = new jspdf.jsPDF(); pdf.addImage(img, 'PNG', 10, 10, 190, 0); pdf.save('note.pdf'); }
            });
        };
    </script>
</body>
</html>